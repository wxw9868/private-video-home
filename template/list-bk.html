<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.title}}</title>
    <link href="assets/image/favicon/favicon.ico" rel="shortcut icon">
    <!-- 引入Bootstrap CSS -->
<!--    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <!-- 自定义CSS样式 -->
    <link type="text/css" rel="stylesheet" href="assets/css/list.css" />
</head>
<body>

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <h3>视频列表</h3>
        </div>
        <div class="col-md-12">
            {{range $index,$actress := .actressList}}
            <a href="/?actress_id={{$index}}">{{$actress}}</a> |
            {{end}}
        </div>
    </div>

    <div class="row video-list">
        <!-- 视频列表项 -->
        <div class="col-md-6 col-lg-4 col-xl-3 video-item">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">视频标题</h5>
                    <p class="card-text">视频描述</p>
                    <a href="#" class="btn btn-primary watch-video">观看视频</a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="pagination">
    <button id="first-page" disabled>首页</button>
    <button id="prev-page" disabled>上一页</button>
    <span id="page-numbers"></span>
    <button id="next-page">下一页</button>
    <button id="last-page">尾页</button>
</div>

<!-- 引入Bootstrap和jQuery -->
<!--<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>-->
<!--<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/mhDoLbDldZc3qpsJHpLogda//BVZbgYuw6kof4u2FrCedxOtgRZDTHgHUhOCVim" crossorigin="anonymous"></script>
<!-- 自定义JavaScript -->
<script>
    let jsonStr = '{{ .data }}'
    // console.log(jsonStr)
    console.log(eval(jsonStr))
    function parseJSON(str) {
        try {
            return eval(jsonStr);
        } catch (e) {
            console.log(e);
            //返回默认对象，或根据用例返回。
            return str
        }
    }
    // 假设这是从服务器或其他地方获取的视频列表数据
    let videoList = parseJSON(jsonStr);
    const videosPerPage = 8;
    let currentPage = 1;
    let totalPages;

    // 渲染视频列表
    function renderVideoList(start, end) {
        const videoListContainer = document.querySelector('.video-list');
        videoListContainer.innerHTML = '';

        for (let i = start; i < end && i < videoList.length; i++) {
            const videoItem = document.createElement('div');
            videoItem.classList.add('col-md-6', 'col-lg-4', 'col-xl-3', 'video-item');

            const card = document.createElement('div')
            card.classList.add('card')

            const cardBody = document.createElement('div')
            cardBody.classList.add('card-body')

            const cardTitle = document.createElement('h5')
            cardTitle.classList.add('card-title')
            cardTitle.textContent = `${videoList[i].title}`
            const cardText = document.createElement('p')
            cardText.classList.add('card-text')
            // cardText.textContent = `女优：${videoList[i].actress}，大小：${videoList[i].size}，时间：${videoList[i].mod_time}` //视频描述
            cardText.innerHTML = `
            <b>女优：</b>${videoList[i].actress} <br>
            <b>大小：</b>${videoList[i].size} <br>
            <b>时间：</b>${videoList[i].mod_time}`
            const watchVideo = document.createElement('a')
            watchVideo.classList.add('btn', 'btn-primary', 'watch-video')
            watchVideo.setAttribute('target', '_blank')
            watchVideo.setAttribute('href', '/play?id=' + `${videoList[i].id - 1}`)
            watchVideo.textContent = '观看视频'

            cardBody.appendChild(cardTitle)
            cardBody.appendChild(cardText)
            cardBody.appendChild(watchVideo)
            card.appendChild(cardBody)
            videoItem.appendChild(card)
            videoListContainer.appendChild(videoItem);

            // const videoItem = document.createElement('div');
            // videoItem.classList.add('video-item');
            // videoItem.innerHTML = `<h3>${videoList[i].title}</h3>`; // 简化版
            // videoListContainer.appendChild(videoItem);
        }

        // 更新分页控件
        updatePagination();
    }

    // 更新分页控件
    function updatePagination() {
        const pageNumbers = document.querySelector('#page-numbers');
        pageNumbers.innerHTML = '';

        const startPage = Math.max(currentPage - 5, 1);
        const endPage = Math.min(currentPage + 5, totalPages);

        for (let i = startPage; i <= endPage; i++) {
            const btn = document.createElement('button');
            btn.textContent = i;
            btn.addEventListener('click', () => {
                currentPage = i;
                renderVideoList((i - 1) * videosPerPage, i * videosPerPage);
            });

            if (i === currentPage) {
                btn.classList.add('active');
            }

            pageNumbers.appendChild(btn);
        }

        // 启用/禁用“首页”和“尾页”按钮
        const firstPageBtn = document.querySelector('#first-page');
        firstPageBtn.disabled = currentPage === 1;
        const lastPageBtn = document.querySelector('#last-page');
        lastPageBtn.disabled = currentPage === totalPages;

        // 启用/禁用“上一页”和“下一页”按钮
        const prevPageBtn = document.querySelector('#prev-page');
        prevPageBtn.disabled = currentPage === 1;
        const nextPageBtn = document.querySelector('#next-page');
        nextPageBtn.disabled = currentPage === totalPages;
    }

    // 计算总页数并初始化
    totalPages = Math.ceil(videoList.length / videosPerPage);
    renderVideoList(0, videosPerPage);

    // 事件监听器
    document.querySelector('#prev-page').addEventListener('click', () => {
        if (currentPage > 1) {
            currentPage--;
            renderVideoList((currentPage - 1) * videosPerPage, currentPage * videosPerPage);
        }
    });

    document.querySelector('#next-page').addEventListener('click', () => {
        if (currentPage < totalPages) {
            currentPage++;
            renderVideoList((currentPage - 1) * videosPerPage, currentPage * videosPerPage);
        }
    });

    document.querySelector('#first-page').addEventListener('click', () => {
        if (currentPage > 1) {
            currentPage = 1;
            renderVideoList((currentPage - 1) * videosPerPage, currentPage * videosPerPage);
        }
    });

    document.querySelector('#last-page').addEventListener('click', () => {
        if (currentPage < totalPages) {
            currentPage = totalPages;
            renderVideoList((currentPage - 1) * videosPerPage, currentPage * videosPerPage);
        }
    });
</script>

</body>
</html>
